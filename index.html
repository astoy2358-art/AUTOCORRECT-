<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-Powered Autocorrect Tool</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <header class="text-center mb-8">
            <h1 id="appName" class="text-3xl font-bold text-blue-600">AI-Powered Autocorrect Tool</h1>
            <p id="appDescription" class="text-gray-600 mt-2">Correct spelling errors using advanced NLP techniques</p>
        </header>
        
        <div class="grid md:grid-cols-2 gap-8">
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-xl font-semibold mb-4">Input Text</h2>
                <textarea 
                    id="inputText" 
                    class="w-full h-64 p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500" 
                    placeholder="Type or paste your text here..."
                ></textarea>
                <div class="mt-4 flex justify-between items-center">
                    <button 
                        id="correctBtn" 
                        class="bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-6 rounded-md transition duration-200 flex items-center"
                    >
                        Correct Text
                    </button>
                    <div id="loading" class="hidden mr-4">
                        <div class="loading"></div>
                        <span class="ml-2 text-gray-600">Processing...</span>
                    </div>
                </div>
                
                <div class="mt-4">
                    <h3 class="font-medium text-gray-700 mb-2">Example Texts</h3>
                    <div id="exampleTexts" class="flex flex-wrap gap-2">
                        <!-- Example texts will be inserted here by JavaScript -->
                    </div>
                </div>
            </div>
            
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-xl font-semibold mb-4">Corrected Text</h2>
                <div 
                    id="outputText" 
                    class="w-full h-64 p-3 border border-gray-300 rounded-md bg-gray-50 overflow-auto"
                ></div>
                <div class="mt-4 flex justify-end">
                    <button 
                        id="copyBtn" 
                        class="bg-green-600 hover:bg-green-700 text-white font-medium py-2 px-6 rounded-md transition duration-200"
                    >
                        Copy to Clipboard
                    </button>
                </div>
            </div>
        </div>
        
        <div class="mt-8 bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-4">How It Works</h2>
            <div class="grid md:grid-cols-3 gap-4">
                <div class="bg-blue-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-blue-700">1. Text Analysis</h3>
                    <p class="text-sm mt-2">Your text is analyzed word by word using natural language processing techniques.</p>
                </div>
                <div class="bg-green-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-green-700">2. Candidate Generation</h3>
                    <p class="text-sm mt-2">For each potentially misspelled word, similar candidates are generated using edit distance.</p>
                </div>
                <div class="bg-purple-50 p-4 rounded-lg">
                    <h3 class="font-semibold text-purple-700">3. Statistical Ranking</h3>
                    <p class="text-sm mt-2">Candidates are ranked by similarity and frequency to select the most likely correction.</p>
                </div>
            </div>
        </div>
        
        <div class="mt-8 bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-4">Word Frequency Analysis</h2>
            <p class="text-gray-600 mb-4">This chart shows the top <span id="chartTopN">20</span> most frequent words in our dataset:</p>
            <div class="flex justify-center">
                <img src="{{ url_for('static', filename='chart.png') }}" alt="Word Frequency Chart" class="max-w-full h-auto">
            </div>
        </div>
        
        <div class="mt-8 bg-white p-6 rounded-lg shadow-md">
            <h2 class="text-xl font-semibold mb-4">Algorithm Details</h2>
            <div class="grid md:grid-cols-2 gap-4">
                <div>
                    <h3 class="font-medium text-gray-700">Settings</h3>
                    <ul class="mt-2 text-sm text-gray-600">
                        <li>Max Edit Distance: <span id="maxEditDistance">2</span></li>
                        <li>Max Candidates: <span id="maxCandidates">5</span></li>
                        <li>Min Word Length: <span id="minWordLength">3</span></li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-medium text-gray-700">Techniques</h3>
                    <ul class="mt-2 text-sm text-gray-600">
                        <li>Preprocessing: <span id="preprocessingMethod">nltk.word_tokenize</span></li>
                        <li>Distance Metric: <span id="distanceMetric">levenshtein</span></li>
                        <li>Ranking Method: <span id="rankingMethod">edit_distance_and_frequency</span></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration object (would typically be loaded from a JSON file)
        const config = {
            "ai_autocorrect_config": {
                "name": "AI-Powered Autocorrect Tool",
                "version": "1.0.0",
                "description": "A sophisticated web-based autocorrect tool that corrects spelling errors using statistical NLP techniques",
                "settings": {
                    "max_edit_distance": 2,
                    "max_candidates": 5,
                    "min_word_length": 3,
                    "chart_top_n_words": 20,
                    "api_endpoint": "/correct",
                    "default_language": "english"
                },
                "supported_languages": [
                    {
                        "code": "en",
                        "name": "English",
                        "dataset": "word_frequencies.csv"
                    }
                ],
                "ui_config": {
                    "theme": {
                        "primary_color": "#2563eb",
                        "secondary_color": "#059669",
                        "background_color": "#f3f4f6"
                    },
                    "text_area": {
                        "rows": 10,
                        "placeholder": "Type or paste your text here..."
                    },
                    "buttons": {
                        "correct_text": "Correct Text",
                        "copy_text": "Copy to Clipboard"
                    }
                },
                "algorithm_details": {
                    "preprocessing": "nltk.word_tokenize",
                    "distance_metric": "levenshtein",
                    "ranking_method": "edit_distance_and_frequency"
                },
                "example_texts": [
                    "Ths is an exmple of text with som spelling erors.",
                    "I hav a dreem that one day this nation will rise up.",
                    "The qick brown fox jmps ovr the lazy dog.",
                    "Artifishal intelgence is transformng our world."
                ]
            }
        };

        document.addEventListener('DOMContentLoaded', function() {
            // Apply configuration to UI
            document.getElementById('appName').textContent = config.ai_autocorrect_config.name;
            document.getElementById('appDescription').textContent = config.ai_autocorrect_config.description;
            
            // Apply settings to UI elements
            document.getElementById('chartTopN').textContent = config.ai_autocorrect_config.settings.chart_top_n_words;
            document.getElementById('maxEditDistance').textContent = config.ai_autocorrect_config.settings.max_edit_distance;
            document.getElementById('maxCandidates').textContent = config.ai_autocorrect_config.settings.max_candidates;
            document.getElementById('minWordLength').textContent = config.ai_autocorrect_config.settings.min_word_length;
            
            // Apply algorithm details
            document.getElementById('preprocessingMethod').textContent = config.ai_autocorrect_config.algorithm_details.preprocessing;
            document.getElementById('distanceMetric').textContent = config.ai_autocorrect_config.algorithm_details.distance_metric;
            document.getElementById('rankingMethod').textContent = config.ai_autocorrect_config.algorithm_details.ranking_method;
            
            // Add example texts
            const exampleTextsContainer = document.getElementById('exampleTexts');
            config.ai_autocorrect_config.example_texts.forEach(text => {
                const button = document.createElement('button');
                button.textContent = text.substring(0, 20) + '...';
                button.title = text;
                button.className = 'text-xs bg-gray-200 hover:bg-gray-300 text-gray-800 py-1 px-2 rounded';
                button.addEventListener('click', () => {
                    document.getElementById('inputText').value = text;
                });
                exampleTextsContainer.appendChild(button);
            });
            
            const inputText = document.getElementById('inputText');
            const outputText = document.getElementById('outputText');
            const correctBtn = document.getElementById('correctBtn');
            const copyBtn = document.getElementById('copyBtn');
            const loading = document.getElementById('loading');
            
            // Function to highlight differences between two texts
            function highlightDifferences(original, corrected) {
                const originalWords = original.split(/\b/);
                const correctedWords = corrected.split(/\b/);
                let result = '';
                let i = 0, j = 0;
                
                while (i < originalWords.length && j < correctedWords.length) {
                    if (originalWords[i] === correctedWords[j]) {
                        result += originalWords[i];
                        i++;
                        j++;
                    } else {
                        // Find where the next match occurs
                        let k = 1;
                        while (i + k < originalWords.length && 
                               j + k < correctedWords.length && 
                               originalWords[i + k] !== correctedWords[j + k]) {
                            k++;
                        }
                        
                        // Highlight the changed word
                        result += `<span class="word-diff">${correctedWords[j]}</span>`;
                        j++;
                        i++;
                    }
                }
                
                // Add any remaining words
                while (j < correctedWords.length) {
                    result += `<span class="word-diff">${correctedWords[j]}</span>`;
                    j++;
                }
                
                return result;
            }
            
            correctBtn.addEventListener('click', async function() {
                const text = inputText.value.trim();
                
                if (!text) {
                    alert('Please enter some text to correct.');
                    return;
                }
                
                // Show loading indicator
                loading.classList.remove('hidden');
                correctBtn.disabled = true;
                
                try {
                    const response = await fetch(config.ai_autocorrect_config.settings.api_endpoint, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({ text: text })
                    });
                    
                    const data = await response.json();
                    
                    if (data.error) {
                        alert('Error: ' + data.error);
                    } else {
                        // Highlight differences between original and corrected text
                        const highlighted = highlightDifferences(text, data.corrected_text);
                        outputText.innerHTML = highlighted;
                    }
                } catch (error) {
                    alert('An error occurred: ' + error.message);
                } finally {
                    // Hide loading indicator
                    loading.classList.add('hidden');
                    correctBtn.disabled = false;
                }
            });
            
            copyBtn.addEventListener('click', function() {
                const text = outputText.textContent;
                
                if (!text) {
                    alert('No corrected text to copy.');
                    return;
                }
                
                navigator.clipboard.writeText(text)
                    .then(() => {
                        // Show a temporary success message
                        const originalText = copyBtn.textContent;
                        copyBtn.textContent = 'Copied!';
                        copyBtn.classList.remove('bg-green-600', 'hover:bg-green-700');
                        copyBtn.classList.add('bg-green-500');
                        
                        setTimeout(() => {
                            copyBtn.textContent = originalText;
                            copyBtn.classList.remove('bg-green-500');
                            copyBtn.classList.add('bg-green-600', 'hover:bg-green-700');
                        }, 2000);
                    })
                    .catch(err => {
                        alert('Failed to copy text: ' + err);
                    });
            });
        });
    </script>
</body>
</html>
